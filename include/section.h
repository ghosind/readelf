#include "elf.h"

#ifndef SECTION_H
#define SECTION_H

typedef struct {
  Elf32_Word sh_name;
  Elf32_Word sh_type;
  Elf32_Word sh_flags;
  Elf32_Addr sh_addr;
  Elf32_Off  sh_offset;
  Elf32_Word sh_size;
  Elf32_Word sh_link;
  Elf32_Word sh_info;
  Elf32_Word sh_addralign;
  Elf32_Word sh_entsize;
} Elf32_Shdr;

typedef struct {
  Elf64_Word  sh_name;
  Elf64_Word  sh_type;
  Elf64_Xword sh_flags;
  Elf64_Addr  sh_addr;
  Elf64_Off   sh_offset;
  Elf64_Xword sh_size;
  Elf64_Word  sh_link;
  Elf64_Word  sh_info;
  Elf64_Xword sh_addralign;
  Elf64_Xword sh_entsize;
} Elf64_Shdr;

typedef struct {
  uint32_t sh_name;
  uint32_t sh_type;
  uint64_t sh_flags;
  uint64_t sh_addr;
  uint64_t sh_offset;
  uint64_t sh_size;
  uint32_t sh_link;
  uint32_t sh_info;
  uint64_t sh_addralign;
  uint64_t sh_entsize;
} Elf_Internal_Shdr;

/**
 * Section Types
 */
#define SHT_NULL	        0
#define SHT_PROGBITS	    1
#define SHT_SYMTAB	      2
#define SHT_STRTAB	      3
#define SHT_RELA	        4
#define SHT_HASH	        5
#define SHT_DYNAMIC	      6
#define SHT_NOTE	        7
#define SHT_NOBITS	      8
#define SHT_REL	          9
#define SHT_SHLIB	        10
#define SHT_DYNSYM	      11
#define SHT_INIT_ARRAY	  14
#define SHT_FINI_ARRAY	  15
#define SHT_PREINIT_ARRAY 16
#define SHT_GROUP         17
#define SHT_SYMTAB_SHNDX  18
#define SHT_LOOS	        0x60000000
#define SHT_HIOS	        0x6fffffff
#define SHT_LOPROC	      0x70000000
#define SHT_HIPROC	      0x7fffffff
#define SHT_LOUSER	      0x80000000
#define SHT_HIUSER	      0xffffffff

/**
 * Section Attribute Flags
 */
#define SHF_WRITE	            0x1
#define SHF_ALLOC	            0x2
#define SHF_EXECINSTR	        0x4
#define SHF_MERGE	            0x10
#define SHF_STRINGS	          0x20
#define SHF_INFO_LINK	        0x40
#define SHF_LINK_ORDER	      0x80
#define SHF_OS_NONCONFORMING  0x100
#define SHF_GROUP	            0x200
#define SHF_TLS	              0x400
#define SHF_COMPRESSED	      0x800
#define SHF_MASKOS	          0x0ff00000
#define SHF_MASKPROC	        0xf0000000

#endif // SECTION_H
